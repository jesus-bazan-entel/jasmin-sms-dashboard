{"ast":null,"code":"import React,{Suspense,lazy}from\"react\";import{Routes,Route,Navigate}from\"react-router-dom\";import{Box,CircularProgress}from\"@mui/material\";import{useAuth}from\"./contexts/AuthContext\";import{useWebSocket}from\"./contexts/WebSocketContext\";// Importar todas las páginas desde el archivo index\nimport{LoginPage,RegisterPage,ForgotPasswordPage,DashboardLayout,Dashboard,Campaigns,CampaignDetail,CreateCampaign,Contacts,ContactDetail,ContactLists,Messages,MessageDetail,Templates,TemplateEditor,Connectors,ConnectorDetail,Routing,RoutingBuilder,Analytics,Reports,Billing,BillingDetail,Users,UserDetail,Settings,Profile,ApiDocs,Webhooks,Logs,NotFound,Unauthorized,ServerError}from\"./pages\";// Componente de carga\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LoadingFallback=()=>/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",minHeight:\"100vh\",flexDirection:\"column\",gap:2,children:[/*#__PURE__*/_jsx(CircularProgress,{size:60,thickness:4}),/*#__PURE__*/_jsx(Box,{sx:{color:\"text.secondary\",fontSize:\"1.1rem\"},children:\"Cargando Jasmin SMS Dashboard...\"})]});// Componente de ruta protegida\nconst ProtectedRoute=_ref=>{let{children,requiredRole=null}=_ref;const{user,isAuthenticated,loading}=useAuth();if(loading){return/*#__PURE__*/_jsx(LoadingFallback,{});}if(!isAuthenticated){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}// Verificar rol si es requerido\nif(requiredRole&&(user===null||user===void 0?void 0:user.role)!==requiredRole){// Verificar jerarquía de roles\nconst roleHierarchy={user:1,operator:2,manager:3,admin:4,super_admin:5};const userRoleLevel=roleHierarchy[user===null||user===void 0?void 0:user.role]||0;const requiredRoleLevel=roleHierarchy[requiredRole]||0;if(userRoleLevel<requiredRoleLevel){return/*#__PURE__*/_jsx(Navigate,{to:\"/unauthorized\",replace:true});}}return children;};// Componente de ruta pública (solo para usuarios no autenticados)\nconst PublicRoute=_ref2=>{let{children}=_ref2;const{isAuthenticated,loading}=useAuth();if(loading){return/*#__PURE__*/_jsx(LoadingFallback,{});}if(isAuthenticated){return/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true});}return children;};// Componente principal de la aplicación\nfunction App(){const{isAuthenticated,loading:authLoading}=useAuth();const{connectionStatus}=useWebSocket();// Mostrar loading mientras se inicializa la autenticación\nif(authLoading){return/*#__PURE__*/_jsx(LoadingFallback,{});}return/*#__PURE__*/_jsxs(Box,{sx:{minHeight:\"100vh\",backgroundColor:\"background.default\"},children:[/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(LoadingFallback,{}),children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(PublicRoute,{children:/*#__PURE__*/_jsx(LoginPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(PublicRoute,{children:/*#__PURE__*/_jsx(RegisterPage,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/forgot-password\",element:/*#__PURE__*/_jsx(PublicRoute,{children:/*#__PURE__*/_jsx(ForgotPasswordPage,{})})}),/*#__PURE__*/_jsxs(Route,{path:\"/\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(DashboardLayout,{})}),children:[/*#__PURE__*/_jsx(Route,{index:true,element:/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"dashboard\",element:/*#__PURE__*/_jsx(Dashboard,{})}),/*#__PURE__*/_jsx(Route,{path:\"campaigns\",element:/*#__PURE__*/_jsx(Campaigns,{})}),/*#__PURE__*/_jsx(Route,{path:\"campaigns/create\",element:/*#__PURE__*/_jsx(CreateCampaign,{})}),/*#__PURE__*/_jsx(Route,{path:\"campaigns/:id\",element:/*#__PURE__*/_jsx(CampaignDetail,{})}),/*#__PURE__*/_jsx(Route,{path:\"contacts\",element:/*#__PURE__*/_jsx(Contacts,{})}),/*#__PURE__*/_jsx(Route,{path:\"contacts/lists\",element:/*#__PURE__*/_jsx(ContactLists,{})}),/*#__PURE__*/_jsx(Route,{path:\"contacts/:id\",element:/*#__PURE__*/_jsx(ContactDetail,{})}),/*#__PURE__*/_jsx(Route,{path:\"messages\",element:/*#__PURE__*/_jsx(Messages,{})}),/*#__PURE__*/_jsx(Route,{path:\"messages/:id\",element:/*#__PURE__*/_jsx(MessageDetail,{})}),/*#__PURE__*/_jsx(Route,{path:\"templates\",element:/*#__PURE__*/_jsx(Templates,{})}),/*#__PURE__*/_jsx(Route,{path:\"templates/create\",element:/*#__PURE__*/_jsx(TemplateEditor,{})}),/*#__PURE__*/_jsx(Route,{path:\"templates/:id/edit\",element:/*#__PURE__*/_jsx(TemplateEditor,{})}),/*#__PURE__*/_jsx(Route,{path:\"connectors\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"manager\",children:/*#__PURE__*/_jsx(Connectors,{})})}),/*#__PURE__*/_jsx(Route,{path:\"connectors/:id\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"manager\",children:/*#__PURE__*/_jsx(ConnectorDetail,{})})}),/*#__PURE__*/_jsx(Route,{path:\"routing\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"manager\",children:/*#__PURE__*/_jsx(Routing,{})})}),/*#__PURE__*/_jsx(Route,{path:\"routing/builder\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"manager\",children:/*#__PURE__*/_jsx(RoutingBuilder,{})})}),/*#__PURE__*/_jsx(Route,{path:\"analytics\",element:/*#__PURE__*/_jsx(Analytics,{})}),/*#__PURE__*/_jsx(Route,{path:\"reports\",element:/*#__PURE__*/_jsx(Reports,{})}),/*#__PURE__*/_jsx(Route,{path:\"billing\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"manager\",children:/*#__PURE__*/_jsx(Billing,{})})}),/*#__PURE__*/_jsx(Route,{path:\"billing/:id\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"manager\",children:/*#__PURE__*/_jsx(BillingDetail,{})})}),/*#__PURE__*/_jsx(Route,{path:\"users\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"admin\",children:/*#__PURE__*/_jsx(Users,{})})}),/*#__PURE__*/_jsx(Route,{path:\"users/:id\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"admin\",children:/*#__PURE__*/_jsx(UserDetail,{})})}),/*#__PURE__*/_jsx(Route,{path:\"api\",element:/*#__PURE__*/_jsx(ApiDocs,{})}),/*#__PURE__*/_jsx(Route,{path:\"webhooks\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"manager\",children:/*#__PURE__*/_jsx(Webhooks,{})})}),/*#__PURE__*/_jsx(Route,{path:\"logs\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"admin\",children:/*#__PURE__*/_jsx(Logs,{})})}),/*#__PURE__*/_jsx(Route,{path:\"settings\",element:/*#__PURE__*/_jsx(ProtectedRoute,{requiredRole:\"admin\",children:/*#__PURE__*/_jsx(Settings,{})})}),/*#__PURE__*/_jsx(Route,{path:\"profile\",element:/*#__PURE__*/_jsx(Profile,{})})]}),/*#__PURE__*/_jsx(Route,{path:\"/unauthorized\",element:/*#__PURE__*/_jsx(Unauthorized,{})}),/*#__PURE__*/_jsx(Route,{path:\"/server-error\",element:/*#__PURE__*/_jsx(ServerError,{})}),/*#__PURE__*/_jsx(Route,{path:\"/404\",element:/*#__PURE__*/_jsx(NotFound,{})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(NotFound,{})})]})}),isAuthenticated&&connectionStatus!==\"connected\"&&/*#__PURE__*/_jsxs(Box,{sx:{position:\"fixed\",bottom:16,right:16,backgroundColor:connectionStatus===\"connecting\"?\"warning.main\":\"error.main\",color:\"white\",padding:\"8px 16px\",borderRadius:1,fontSize:\"0.875rem\",zIndex:9999,display:\"flex\",alignItems:\"center\",gap:1},children:[connectionStatus===\"connecting\"&&/*#__PURE__*/_jsx(CircularProgress,{size:16,color:\"inherit\"}),connectionStatus===\"connecting\"?\"Conectando...\":\"Sin conexión en tiempo real\"]})]});}export default App;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}